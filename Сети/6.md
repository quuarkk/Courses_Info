

### Конспект лекции: Транспортный уровень (TCP/UDP), атаки и безопасность

---

#### **1. Повторение предыдущих тем**
- **ARP-протокол**: Связывает IP-адреса с MAC-адресами.  
  - **Gratuitous ARP**: Широковещательный запрос для обновления ARP-таблиц.  
  - **ARP-спуфинг**: Атака, где злоумышленник подменяет MAC-адрес шлюза, перехватывая трафик (Man-in-the-Middle).  
- **IP-протокол**:  
  - **TTL (Time-to-Live)**: Поле, ограничивающее время жизни пакета (уменьшается на 1 при прохождении каждого маршрутизатора).  
  - **ICMP**: Протокол диагностики (ping, traceroute). Уязвим к атакам типа **ICMP-флуд** (DoS).  

---

#### **2. Транспортный уровень: TCP vs UDP**
- **TCP (Transmission Control Protocol)**:  
  - **Надежный протокол**: Гарантирует доставку данных, упорядочивает пакеты, управляет потоком.  
  - **Трехстороннее рукопожатие**:  
    1. SYN (синхронизация) →  
    2. SYN-ACK (подтверждение) →  
    3. ACK (завершение установки соединения).  
  - **Поля заголовка**:  
    - **Порядковый номер (Sequence Number)**: Идентифицирует байты в потоке данных.  
    - **Подтверждение (Acknowledgment Number)**: Номер следующего ожидаемого байта.  
    - **Управляющие биты**: SYN, ACK, FIN (завершение), RST (сброс), PSH (немедленная передача), URG (приоритет).  
  - **Окно TCP (Window)**: Размер данных, передаваемых без подтверждения. Динамически регулируется для управления перегрузками.  

- **UDP (User Datagram Protocol)**:  
  - **Ненадежный протокол**: Без гарантии доставки, подтверждений или упорядочивания.  
  - **Применение**: Видеоконференции, DNS, игры (низкая задержка критичнее надежности).  
  - **Заголовок UDP**: Порты источника/назначения, длина данных, контрольная сумма.  

---

#### **3. Порты и сокеты**
- **Порт**: 16-битное число, идентифицирующее сетевое приложение.  
  - **Well-known порты (0-1023)**: Зарезервированы для системных служб (HTTP — 80, HTTPS — 443, DNS — 53).  
  - **Зарегистрированные порты (1024-49151)**: Для пользовательских приложений.  
  - **Эфемерные порты (49152-65535)**: Временные порты для клиентских соединений.  
- **Сокет**: Уникальный идентификатор соединения (IP-адрес + порт). Пример: `192.168.1.1:80`.  

---

#### **4. Атаки на транспортном уровне**
- **DoS/DDoS (Denial-of-Service)**:  
  - **SYN-флуд**: Злоумышленник отправляет множество SYN-запросов, исчерпывая ресурсы сервера (ожидание подтверждений).  
  - **UDP-флуд**: Заполнение канала фиктивными UDP-пакетами.  
- **Методы защиты**:  
  - **Фильтрация трафика**: Блокировка подозрительных IP.  
  - **SYN Cookies**: Сервер генерирует временные идентификаторы для SYN-запросов, не выделяя ресурсы до подтверждения.  
  - **Черные списки**: Блокировка источников атак.  

---

#### **5. Управление потоком в TCP**
- **Размер окна (Window Size)**:  
  - Регулирует объем данных, передаваемых без подтверждения.  
  - **Алгоритм «скользящего окна»**: Увеличивает скорость при стабильном соединении, снижает при потерях.  
- **Повторная передача**:  
  - Таймеры на каждый сегмент. При превышении времени ожидания пакет отправляется заново.  

---

#### **6. Примеры уязвимостей**
- **Переполнение буфера**: Эксплуатация ошибок в обработке TCP/UDP-пакетов.  
- **Подмена IP-адресов (IP Spoofing)**: Подделка источника пакетов для обхода защиты.  
- **Сессия-фиксация**: Перехват или подмена TCP-сеанса для доступа к данным.  

---

**Ключевые термины**:  
- TCP, UDP, трехстороннее рукопожатие, SYN-флуд, сокет, порт, окно TCP, DoS/DDoS, порядковый номер, подтверждение (ACK).  

---

**Логические связи**:  
- TCP обеспечивает надежность через подтверждения и управление потоком, но уязвим к DoS-атакам из-за ресурсоемкости.  
- UDP, не требуя подтверждений, быстрее, но подходит только для трафика, устойчивого к потерям.  
- Порты и сокеты идентифицируют приложения, что делает их мишенью для атак (например, SYN-флуд на 80-й порт).
